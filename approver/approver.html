<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Dasher UI - Approver Dashboard</title>
    <link rel="stylesheet" href="../theme.css">
    <link rel="stylesheet" href="approver.css">
    <link href="https://fonts.googleapis.com/css?family=Inter:400,500,600,700&display=swap" rel="stylesheet">
    <!-- Bootstrap 5 CSS -->
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.2/dist/css/bootstrap.min.css" rel="stylesheet">
    <!-- Font Awesome 5 -->
    <link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.15.4/css/all.min.css" rel="stylesheet">
    <!-- Chart.js -->
    <script src="https://cdn.jsdelivr.net/npm/chart.js@4.4.1/dist/chart.umd.min.js"></script>
    <!-- XLSX for Excel export -->
    <script src="https://cdnjs.cloudflare.com/ajax/libs/xlsx/0.18.5/xlsx.full.min.js"></script>
</head>

<body class="dasher-bg">
    <!-- Sidebar -->
    <nav id="sidebar" class="sidebar bg-white border-end position-fixed top-0 start-0 vh-100 d-flex flex-column">
        <div class="sidebar-logo p-3 border-bottom text-center">
            <img src="../images/HIA_logo.png" alt="HIA Logo" class="mb-2"
                style="height: 60px; max-width: 100%; object-fit: contain;">
        </div>

        <!-- Profile Section -->
        <div class="sidebar-profile p-3 border-bottom">
            <div class="profile-info">
                <div class="profile-avatar text-center mb-2">
                    <div class="avatar-circle bg-primary text-white d-inline-flex align-items-center justify-content-center rounded-circle"
                        style="width: 50px; height: 50px; font-size: 18px; font-weight: 600;" id="profileInitials">
                        AP
                    </div>
                </div>
                <div class="profile-details text-center">
                    <h6 class="profile-name mb-1 fw-bold text-dark" id="profileName">Approver</h6>
                    <p class="profile-email mb-1 text-muted small" id="profileEmail">approver@hia.gov.ae</p>
                    <p class="profile-contact mb-1 text-muted small" id="profilePhone">+971 50 123 4567</p>
                    <p class="last-login mb-0 text-muted" style="font-size: 11px;" id="lastLogin">
                        Last Login: Loading...
                    </p>
                </div>
            </div>
        </div>

        <!-- Account Settings Section -->
        <div class="sidebar-settings p-3 border-bottom">
            <h6 class="settings-title mb-3 text-muted small text-uppercase fw-bold">Account Settings</h6>
            <div class="settings-items">
                <!-- Theme Toggle -->
                <div class="setting-item d-flex align-items-center justify-content-center mb-3">
                    <div class="theme-toggle-container">
                        <div class="theme-slider" id="themeSlider">
                            <div class="theme-option left active" id="lightTheme">
                                <i class="fas fa-sun"></i>
                            </div>
                            <div class="theme-option right" id="darkTheme">
                                <i class="fas fa-moon"></i>
                            </div>
                            <div class="slider-background"></div>
                        </div>
                    </div>
                </div>

                <!-- Update Profile -->
                <div class="setting-item d-flex align-items-center mb-2">
                    <div class="d-flex align-items-center gap-2 flex-grow-1">
                        <i class="fas fa-user-edit text-muted" style="width: 16px;"></i>
                        <a href="#" class="setting-link small text-decoration-none text-dark"
                            onclick="showUpdateProfileModal()">Update Profile</a>
                    </div>
                </div>

                <!-- Update Password -->
                <div class="setting-item d-flex align-items-center mb-2">
                    <div class="d-flex align-items-center gap-2 flex-grow-1">
                        <i class="fas fa-key text-muted" style="width: 16px;"></i>
                        <a href="#" class="setting-link small text-decoration-none text-dark"
                            onclick="showUpdatePasswordModal()">Update Password</a>
                    </div>
                </div>
            </div>
        </div>

        <!-- Logout Section -->
        <div class="sidebar-logout p-3 border-bottom">
            <div class="logout-item d-flex align-items-center justify-content-center">
                <div class="d-flex align-items-center gap-2">
                    <i class="fas fa-sign-out-alt text-danger" style="width: 16px;"></i>
                    <a href="#" class="setting-link small text-decoration-none text-danger fw-medium"
                        onclick="confirmLogout()">Logout</a>
                </div>
            </div>
        </div>

        <ul class="nav flex-column nav-secondary mt-3 flex-grow-1">
            <!-- Navigation content will be added here -->
        </ul>
    </nav>
    <div class="kai-main">
        <header class="main-header">
            <nav class="navbar navbar-header navbar-header-transparent navbar-expand-lg border-bottom">
                <div class="container-fluid">
                    <div class="d-flex align-items-center gap-2" style="max-width: 400px;">
                        <button id="sidebarTrigger" class="btn btn-warning" style="z-index:1200;"
                            data-bs-toggle="tooltip" data-bs-placement="right" title="Open Menu">
                            <i class="fas fa-bars"></i>
                        </button>
                        <form class="flex-grow-1">
                            <div class="input-group">
                                <input type="text" placeholder="Search permits..." class="form-control"
                                    id="searchInput" />
                            </div>
                        </form>
                    </div>
                    <ul class="navbar-nav topbar-nav ms-md-auto align-items-center">
                        <!-- Removed message and notification icons -->
                        <li class="nav-item topbar-user dropdown hidden-caret">
                            <span class="profile-username">Hi, <span class="fw-bold"
                                    id="headerUsername">Approver</span></span>
                            <ul class="dropdown-menu dropdown-user animated fadeIn">
                                <div class="dropdown-user-scroll scrollbar-outer">
                                    <li>
                                        <div class="user-box">
                                            <div class="avatar-lg"><img
                                                    src="https://ui-avatars.com/api/?name=Approver&background=2563eb&color=fff&size=40"
                                                    alt="image profile" class="avatar-img rounded" /></div>
                                            <div class="u-text">
                                                <h4 id="dropdownUsername">Approver</h4>
                                                <p class="text-muted" id="dropdownEmail">approver@example.com</p>
                                                <a href="#" class="btn btn-xs btn-secondary btn-sm"
                                                    onclick="showUpdateProfileModal()">View Profile</a>
                                            </div>
                                        </div>
                                    </li>
                                    <li>
                                        <div class="dropdown-divider"></div>
                                        <a class="dropdown-item" href="#" onclick="showUpdateProfileModal()">My
                                            Profile</a>
                                        <div class="dropdown-divider"></div>
                                        <a class="dropdown-item" href="#" onclick="showUpdatePasswordModal()">Account
                                            Settings</a>
                                        <div class="dropdown-divider"></div>
                                        <a class="dropdown-item" href="#" onclick="confirmLogout()">Logout</a>
                                    </li>
                                </div>
                            </ul>
                        </li>
                    </ul>
                </div>
            </nav>
        </header>
        <main class="kai-content">
            <!-- Dashboard Cards Row - Permit Stats and Percentages -->
            <div class="row g-4 mb-4">
                <!-- Total Permits -->
                <div class="col-12 col-sm-6 col-md-4">
                    <div class="card card-stats card-round h-100 shadow-sm">
                        <div class="card-body d-flex align-items-center gap-3">
                            <div class="icon-big text-center rounded-3 d-flex align-items-center justify-content-center"
                                style="background:#1769ff;width:80px;height:80px;">
                                <i class="fas fa-file-alt fa-2x text-white"></i>
                            </div>
                            <div>
                                <p class="card-category mb-1 text-muted">Total Permits</p>
                                <h4 id="totalPermitsCount" class="card-title mb-0 fw-bold">0</h4>
                            </div>
                        </div>
                    </div>
                </div>
                <!-- Approved Permits -->
                <div class="col-12 col-sm-6 col-md-4">
                    <div class="card card-stats card-round h-100 shadow-sm">
                        <div class="card-body d-flex align-items-center gap-3">
                            <div class="icon-big text-center rounded-3 d-flex align-items-center justify-content-center"
                                style="background:#22c55e;width:80px;height:80px;">
                                <i class="fas fa-check-circle fa-2x text-white"></i>
                            </div>
                            <div>
                                <p class="card-category mb-1 text-muted">Approved Permits</p>
                                <h4 id="approvedPermitsCount" class="card-title mb-0 fw-bold">0</h4>
                            </div>
                        </div>
                    </div>
                </div>
                <!-- Approved % -->
                <div class="col-12 col-sm-6 col-md-4">
                    <div class="card card-stats card-round h-100 shadow-sm">
                        <div class="card-body d-flex align-items-center gap-3">
                            <div class="icon-big text-center rounded-3 d-flex align-items-center justify-content-center"
                                style="background:#22c55e;width:80px;height:80px;">
                                <i class="fas fa-percentage fa-2x text-white"></i>
                            </div>
                            <div>
                                <p class="card-category mb-1 text-muted">Approved %</p>
                                <h4 id="approvedPercentage" class="card-title mb-0 fw-bold">0%</h4>
                            </div>
                        </div>
                    </div>
                </div>
                <!-- Rejected Permits -->
                <div class="col-12 col-sm-6 col-md-4">
                    <div class="card card-stats card-round h-100 shadow-sm">
                        <div class="card-body d-flex align-items-center gap-3">
                            <div class="icon-big text-center rounded-3 d-flex align-items-center justify-content-center"
                                style="background:#ef4444;width:80px;height:80px;">
                                <i class="fas fa-times-circle fa-2x text-white"></i>
                            </div>
                            <div>
                                <p class="card-category mb-1 text-muted">Rejected Permits</p>
                                <h4 id="rejectedPermitsCount" class="card-title mb-0 fw-bold">0</h4>
                            </div>
                        </div>
                    </div>
                </div>
                <!-- Rejected % -->
                <div class="col-12 col-sm-6 col-md-4">
                    <div class="card card-stats card-round h-100 shadow-sm">
                        <div class="card-body d-flex align-items-center gap-3">
                            <div class="icon-big text-center rounded-3 d-flex align-items-center justify-content-center"
                                style="background:#ef4444;width:80px;height:80px;">
                                <i class="fas fa-percentage fa-2x text-white"></i>
                            </div>
                            <div>
                                <p class="card-category mb-1 text-muted">Rejected %</p>
                                <h4 id="rejectedPercentage" class="card-title mb-0 fw-bold">0%</h4>
                            </div>
                        </div>
                    </div>
                </div>
                <!-- Pending Permits -->
                <div class="col-12 col-sm-6 col-md-4">
                    <div class="card card-stats card-round h-100 shadow-sm">
                        <div class="card-body d-flex align-items-center gap-3">
                            <div class="icon-big text-center rounded-3 d-flex align-items-center justify-content-center"
                                style="background:#8b5cf6;width:80px;height:80px;">
                                <i class="fas fa-hourglass-half fa-2x text-white"></i>
                            </div>
                            <div>
                                <p class="card-category mb-1 text-muted">Pending Permits</p>
                                <h4 id="pendingPermitsCount" class="card-title mb-0 fw-bold">0</h4>
                            </div>
                        </div>
                    </div>
                </div>
                <!-- Pending % -->
                <div class="col-12 col-sm-6 col-md-4">
                    <div class="card card-stats card-round h-100 shadow-sm">
                        <div class="card-body d-flex align-items-center gap-3">
                            <div class="icon-big text-center rounded-3 d-flex align-items-center justify-content-center"
                                style="background:#8b5cf6;width:80px;height:80px;">
                                <i class="fas fa-percentage fa-2x text-white"></i>
                            </div>
                            <div>
                                <p class="card-category mb-1 text-muted">Pending %</p>
                                <h4 id="pendingPercentage" class="card-title mb-0 fw-bold">0%</h4>
                            </div>
                        </div>
                    </div>
                </div>
                <!-- Returned for Info -->
                <div class="col-12 col-sm-6 col-md-4">
                    <div class="card card-stats card-round h-100 shadow-sm">
                        <div class="card-body d-flex align-items-center gap-3">
                            <div class="icon-big text-center rounded-3 d-flex align-items-center justify-content-center"
                                style="background:#f59e42;width:80px;height:80px;">
                                <i class="fas fa-info-circle fa-2x text-white"></i>
                            </div>
                            <div>
                                <p class="card-category mb-1 text-muted">Returned for Info</p>
                                <h4 id="returnedForInfoCount" class="card-title mb-0 fw-bold">0</h4>
                            </div>
                        </div>
                    </div>
                </div>
                <!-- Returned % -->
                <div class="col-12 col-sm-6 col-md-4">
                    <div class="card card-stats card-round h-100 shadow-sm">
                        <div class="card-body d-flex align-items-center gap-3">
                            <div class="icon-big text-center rounded-3 d-flex align-items-center justify-content-center"
                                style="background:#f59e42;width:80px;height:80px;">
                                <i class="fas fa-percentage fa-2x text-white"></i>
                            </div>
                            <div>
                                <p class="card-category mb-1 text-muted">Returned %</p>
                                <h4 id="returnedPercentage" class="card-title mb-0 fw-bold">0%</h4>
                            </div>
                        </div>
                    </div>
                </div>
            </div>

            <!-- Task Progress Widget (Horizontal) -->
            <div class="row mt-4 mb-4">
                <div class="col-12">
                    <div class="card card-round shadow-sm">
                        <div class="card-body">
                            <div class="task-progress-container">
                                <!-- Progress Info Section -->
                                <div class="progress-info-section">
                                    <h5 class="card-title mb-2 fw-bold text-dark">Task Progress</h5>
                                    <h2 id="taskProgressPercentage" class="progress-percentage mb-2 fw-bold text-dark">
                                        0%</h2>
                                    <div class="progress-bar-container">
                                        <div class="progress progress-theme" style="height: 8px; border-radius: 4px;">
                                            <div class="progress-bar"
                                                style="width: 24%; background: linear-gradient(90deg, #06b6d4, #0891b2); border-radius: 4px;">
                                            </div>
                                            <div class="progress-bar"
                                                style="width: 35%; background: linear-gradient(90deg, #10b981, #059669);">
                                            </div>
                                            <div class="progress-bar"
                                                style="width: 41%; background: linear-gradient(90deg, #f59e0b, #d97706); border-radius: 0 4px 4px 0;">
                                            </div>
                                        </div>
                                    </div>
                                </div>

                                <!-- Task Status Items -->
                                <div class="task-status-grid">
                                    <div class="task-status-item">
                                        <div class="task-icon"
                                            style="background: linear-gradient(135deg, #06b6d4, #0891b2);">
                                            <i class="fas fa-check-circle text-white"></i>
                                        </div>
                                        <div class="task-details">
                                            <h4 id="completedTasksCount" class="text-dark">0</h4>
                                            <p>Completed</p>
                                        </div>
                                    </div>

                                    <div class="task-status-item">
                                        <div class="task-icon"
                                            style="background: linear-gradient(135deg, #10b981, #059669);">
                                            <i class="fas fa-spinner text-white"></i>
                                        </div>
                                        <div class="task-details">
                                            <h4 id="inProgressTasksCount" class="text-dark">0</h4>
                                            <p>In-Progress</p>
                                        </div>
                                    </div>

                                    <div class="task-status-item">
                                        <div class="task-icon"
                                            style="background: linear-gradient(135deg, #f59e0b, #d97706);">
                                            <i class="fas fa-clock text-white"></i>
                                        </div>
                                        <div class="task-details">
                                            <h4 id="pendingTasksCount" class="text-dark">0</h4>
                                            <p>Pending</p>
                                        </div>
                                    </div>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>
            </div>

            <!-- Permit Lists -->
            <div class="row mb-4 g-3">
                <!-- Approved Permits -->
                <div class="col-12 col-md-6">
                    <div class="card card-round shadow-sm mini-permit-card">
                        <div class="card-header border-bottom">
                            <h5 class="card-title mb-0 fw-bold text-dark">Approved Permits</h5>
                        </div>
                        <div class="card-body">
                            <div class="table-responsive">
                                <table id="approvedPermitsTable" class="table table-sm table-hover">
                                    <thead class="table-light">
                                        <tr>
                                            <th class="small text-muted">Serial Number</th>
                                            <th class="small text-muted">Permit Number</th>
                                            <th class="small text-muted">Permit Title</th>
                                            <th class="small text-muted">Submitted Date & Time</th>
                                        </tr>
                                    </thead>
                                    <tbody>
                                        <!-- Data will be populated dynamically -->
                                    </tbody>
                                </table>
                            </div>
                        </div>
                    </div>
                </div>

                <!-- Rejected Permits -->
                <div class="col-12 col-md-6">
                    <div class="card card-round shadow-sm mini-permit-card">
                        <div class="card-header border-bottom">
                            <h5 class="card-title mb-0 fw-bold text-dark">Rejected Permits</h5>
                        </div>
                        <div class="card-body">
                            <div class="table-responsive">
                                <table id="rejectedPermitsTable" class="table table-sm table-hover">
                                    <thead class="table-light">
                                        <tr>
                                            <th class="small text-muted">Serial Number</th>
                                            <th class="small text-muted">Permit Number</th>
                                            <th class="small text-muted">Permit Title</th>
                                            <th class="small text-muted">Rejected Date & Time</th>
                                        </tr>
                                    </thead>
                                    <tbody>
                                        <!-- Data will be populated dynamically -->
                                    </tbody>
                                </table>
                            </div>
                        </div>
                    </div>
                </div>
            </div>

            <!-- Statistics and Widgets Row -->
            <div class="row mt-4">
                <div class="col-12">
                    <div class="card card-round mb-3">
                        <div class="card-header">
                            <div class="card-head-row">
                                <div class="card-title">
                                    <h5 class="mb-0 fw-bold">Total Pending Permits</h5>
                                    <small class="text-muted">Review and process pending permit applications</small>
                                </div>
                                <div class="card-tools">
                                    <div class="dropdown">
                                        <button class="btn btn-success btn-sm dropdown-toggle me-2" type="button"
                                            id="exportDropdown" data-bs-toggle="dropdown" aria-expanded="false">
                                            <i class="fas fa-download me-1"></i>Export
                                        </button>
                                        <ul class="dropdown-menu" aria-labelledby="exportDropdown">
                                            <li><a class="dropdown-item" href="#" onclick="exportToCSV()"><i
                                                        class="fas fa-file-csv me-2"></i>Export to CSV</a></li>
                                            <li><a class="dropdown-item" href="#" onclick="exportToExcel()"><i
                                                        class="fas fa-file-excel me-2"></i>Export to Excel</a></li>
                                        </ul>
                                    </div>
                                    <button class="btn btn-info btn-sm" onclick="printTable()">
                                        <i class="fas fa-print me-1"></i>Print
                                    </button>
                                </div>
                            </div>
                        </div>
                        <div class="card-body">
                            <div class="table-responsive">
                                <table id="pendingPermitsTable" class="table table-hover">
                                    <thead class="table-light">
                                        <tr>
                                            <th class="text-center table-header-dynamic" data-field="serialNo">
                                                <div class="header-content">
                                                    <i class="fas fa-hashtag me-2"></i>
                                                    <span>Serial No.</span>
                                                </div>
                                            </th>
                                            <th class="text-center table-header-dynamic" data-field="permitTitle">
                                                <div class="header-content">
                                                    <i class="fas fa-file-contract me-2"></i>
                                                    <span>Permit Title</span>
                                                </div>
                                            </th>
                                            <th class="text-center table-header-dynamic" data-field="submittedDateTime">
                                                <div class="header-content">
                                                    <i class="fas fa-calendar-alt me-2"></i>
                                                    <span>Submitted Date & Time</span>
                                                </div>
                                            </th>
                                            <th class="text-center table-header-dynamic" data-field="preApproverName">
                                                <div class="header-content">
                                                    <i class="fas fa-user-check me-2"></i>
                                                    <span>Pre Approver Name</span>
                                                </div>
                                            </th>
                                            <th class="text-center table-header-dynamic"
                                                data-field="preApproverRemarks">
                                                <div class="header-content">
                                                    <i class="fas fa-comment-alt me-2"></i>
                                                    <span>Pre Approver Remarks</span>
                                                </div>
                                            </th>
                                            <th class="text-center table-header-dynamic" data-field="actions">
                                                <div class="header-content">
                                                    <i class="fas fa-cogs me-2"></i>
                                                    <span>Actions</span>
                                                </div>
                                            </th>
                                        </tr>
                                    </thead>
                                    <tbody>
                                        <!-- Data will be populated dynamically from database -->







                                    </tbody>
                                </table>
                            </div>
                        </div>
                    </div>
                </div>

                <!-- Approved and Rejected Permits tables removed as per request -->
        </main>
    </div>

    <!-- Permit Details Modal -->
    <div class="modal fade" id="permitDetailsModal" tabindex="-1" aria-labelledby="permitDetailsModalLabel"
        aria-hidden="true">
        <div class="modal-dialog modal-xl">
            <div class="modal-content">
                <div class="modal-header">
                    <h5 class="modal-title" id="permitDetailsModalLabel">
                        <i class="fas fa-file-contract me-2"></i>Permit Details
                    </h5>
                    <button type="button" class="btn-close" data-bs-dismiss="modal" aria-label="Close"></button>
                </div>
                <div class="modal-body">
                    <form id="permitDetailsForm">
                        <!-- Requester Details -->
                        <fieldset class="mb-4 border rounded p-3">
                            <legend class="w-auto px-2">Requester Details</legend>
                            <div class="row g-3">
                                <div class="col-md-4">
                                    <label for="modal_fullName" class="form-label">Name</label>
                                    <input type="text" class="form-control" id="modal_fullName" readonly>
                                </div>
                                <div class="col-md-4">
                                    <label for="modal_lastName" class="form-label">Last Name</label>
                                    <input type="text" class="form-control" id="modal_lastName" readonly>
                                </div>
                                <div class="col-md-4">
                                    <label for="modal_corpEmailId" class="form-label">Email Id</label>
                                    <input type="email" class="form-control" id="modal_corpEmailId" readonly>
                                </div>
                                <div class="col-md-4">
                                    <label for="modal_contactDetails" class="form-label">Mobile Number</label>
                                    <input type="text" class="form-control" id="modal_contactDetails" readonly>
                                </div>
                                <div class="col-md-4">
                                    <label for="modal_altContactDetails" class="form-label">Alternate Mobile
                                        Number</label>
                                    <input type="text" class="form-control" id="modal_altContactDetails" readonly>
                                </div>
                            </div>
                        </fieldset>
                        <!-- Work Details -->
                        <fieldset class="mb-4 border rounded p-3">
                            <legend class="w-auto px-2">Work Details</legend>
                            <div class="row g-3">
                                <div class="col-md-4">
                                    <label for="modal_permitTitle" class="form-label">Permit Title</label>
                                    <input type="text" class="form-control" id="modal_permitTitle" readonly>
                                </div>
                                <div class="col-md-4">
                                    <label for="modal_terminal" class="form-label">Terminal</label>
                                    <input type="text" class="form-control" id="modal_terminal" readonly>
                                </div>
                                <div class="col-md-4">
                                    <label for="modal_facility" class="form-label">Facility</label>
                                    <input type="text" class="form-control" id="modal_facility" readonly>
                                </div>
                                <div class="col-md-4">
                                    <label for="modal_specifyTerminal" class="form-label">Specify Terminal</label>
                                    <input type="text" class="form-control" id="modal_specifyTerminal" readonly>
                                </div>
                                <div class="col-md-4">
                                    <label for="modal_specifyFacility" class="form-label">Specify Facility</label>
                                    <input type="text" class="form-control" id="modal_specifyFacility" readonly>
                                </div>
                                <div class="col-md-4">
                                    <label for="modal_impact" class="form-label">Impact on Operation</label>
                                    <input type="text" class="form-control" id="modal_impact" readonly>
                                </div>
                                <div class="col-md-4">
                                    <label for="modal_levelOfImpact" class="form-label">Level of Impact</label>
                                    <input type="text" class="form-control" id="modal_levelOfImpact" readonly>
                                </div>
                                <div class="col-md-4">
                                    <label for="modal_equipmentTypeInput" class="form-label">Type of Affected
                                        Equipment</label>
                                    <input type="text" class="form-control" id="modal_equipmentTypeInput" readonly>
                                </div>
                                <div class="col-md-4">
                                    <label for="modal_impactDetailsInput" class="form-label">Affected Equipment
                                        Details</label>
                                    <textarea class="form-control" id="modal_impactDetailsInput" rows="2"
                                        readonly></textarea>
                                </div>
                                <div class="col-md-4">
                                    <label for="modal_natureOfWork" class="form-label">Nature of Work</label>
                                    <input type="text" class="form-control" id="modal_natureOfWork" readonly>
                                </div>
                                <div class="col-md-8">
                                    <label for="modal_workDescription" class="form-label">Work Description</label>
                                    <textarea class="form-control" id="modal_workDescription" rows="2"
                                        readonly></textarea>
                                </div>
                            </div>
                        </fieldset>
                        <!-- Required Documents -->
                        <fieldset class="mb-4 border rounded p-3">
                            <legend class="w-auto px-2">Required Documents</legend>
                            <div class="row g-3">
                                <div class="col-md-4">
                                    <label for="modal_ePermit" class="form-label">e-Permit Available?</label>
                                    <input type="text" class="form-control" id="modal_ePermit" readonly>
                                </div>
                                <div class="col-md-4">
                                    <label for="modal_ePermitReason" class="form-label">Reason for No e-Permit</label>
                                    <input type="text" class="form-control" id="modal_ePermitReason" readonly>
                                </div>
                                <div class="col-md-4">
                                    <label for="modal_fmmWorkorder" class="form-label">FMM Workorder Available?</label>
                                    <input type="text" class="form-control" id="modal_fmmWorkorder" readonly>
                                </div>
                                <div class="col-md-4">
                                    <label for="modal_noFmmWorkorder" class="form-label">Reason for No FMM
                                        Workorder</label>
                                    <input type="text" class="form-control" id="modal_noFmmWorkorder" readonly>
                                </div>
                                <div class="col-md-4">
                                    <label for="modal_hseRisk" class="form-label">HSE Risk Assessment Available?</label>
                                    <input type="text" class="form-control" id="modal_hseRisk" readonly>
                                </div>
                                <div class="col-md-4">
                                    <label for="modal_noHseRiskAssessmentReason" class="form-label">Reason for No HSE
                                        Risk Assessment</label>
                                    <input type="text" class="form-control" id="modal_noHseRiskAssessmentReason"
                                        readonly>
                                </div>
                                <div class="col-md-4">
                                    <label for="modal_opRisk" class="form-label">Operations Risk Assessment
                                        Available?</label>
                                    <input type="text" class="form-control" id="modal_opRisk" readonly>
                                </div>
                                <div class="col-md-4">
                                    <label for="modal_noOpsRiskAssessmentReason" class="form-label">Reason for No
                                        Operations Risk Assessment</label>
                                    <input type="text" class="form-control" id="modal_noOpsRiskAssessmentReason"
                                        readonly>
                                </div>
                                <div class="col-md-12">
                                    <label class="form-label">Attached Files</label>
                                    <div id="modal_files" class="border rounded p-2 bg-light"></div>
                                </div>
                            </div>
                        </fieldset>
                        <!-- Date & Time -->
                        <fieldset class="mb-4 border rounded p-3">
                            <legend class="w-auto px-2">Date & Time</legend>
                            <div class="row g-3">
                                <div class="col-md-6">
                                    <label for="modal_startDateTime" class="form-label">Start Date & Time</label>
                                    <input type="text" class="form-control" id="modal_startDateTime" readonly>
                                </div>
                                <div class="col-md-6">
                                    <label for="modal_endDateTime" class="form-label">End Date & Time</label>
                                    <input type="text" class="form-control" id="modal_endDateTime" readonly>
                                </div>
                            </div>
                        </fieldset>
                        <!-- Signature -->
                        <fieldset class="mb-4 border rounded p-3">
                            <legend class="w-auto px-2">Signature</legend>
                            <div class="row g-3">
                                <div class="col-md-3">
                                    <label for="modal_signName" class="form-label">Name</label>
                                    <input type="text" class="form-control" id="modal_signName" readonly>
                                </div>
                                <div class="col-md-3">
                                    <label for="modal_signDate" class="form-label">Date</label>
                                    <input type="text" class="form-control" id="modal_signDate" readonly>
                                </div>
                                <div class="col-md-3">
                                    <label for="modal_signTime" class="form-label">Time</label>
                                    <input type="text" class="form-control" id="modal_signTime" readonly>
                                </div>
                                <div class="col-md-3">
                                    <label for="modal_designation" class="form-label">Designation</label>
                                    <input type="text" class="form-control" id="modal_designation" readonly>
                                </div>
                            </div>
                        </fieldset>
                        <!-- Comments (required for Approve/Reject) -->
                        <fieldset class="mb-4 border rounded p-3">
                            <legend class="w-auto px-2">Approval Comments <span class="text-danger">*</span></legend>
                            <textarea class="form-control" id="modal_approvalComments" rows="3" required
                                placeholder="Enter your comments before approving or rejecting..."></textarea>
                        </fieldset>
                        <input type="hidden" id="modal_permitId">
                    </form>
                </div>
                <div class="modal-footer">
                    <button type="button" class="btn btn-secondary" data-bs-dismiss="modal">Close</button>
                    <button type="button" class="btn btn-danger" id="modalRejectBtn">Reject</button>
                    <button type="button" class="btn btn-success" id="modalApproveBtn">Approve</button>
                </div>
            </div>
        </div>
    </div>

    <!-- Update Password Modal -->
    <div class="modal fade" id="updatePasswordModal" tabindex="-1" aria-labelledby="updatePasswordModalLabel"
        aria-hidden="true">
        <div class="modal-dialog">
            <div class="modal-content">
                <div class="modal-header">
                    <h5 class="modal-title" id="updatePasswordModalLabel">
                        <i class="fas fa-key me-2"></i>Update Password
                    </h5>
                    <button type="button" class="btn-close" data-bs-dismiss="modal" aria-label="Close"></button>
                </div>
                <div class="modal-body">
                    <div id="passwordUpdateMessage" class="alert" style="display: none;"></div>
                    <form id="updatePasswordForm">
                        <div class="mb-3">
                            <label for="currentPassword" class="form-label">Current Password</label>
                            <div class="input-group">
                                <input type="password" class="form-control" id="currentPassword" required>
                                <button class="btn btn-outline-secondary" type="button"
                                    onclick="togglePassword('currentPassword')">
                                    <i class="fas fa-eye"></i>
                                </button>
                            </div>
                        </div>
                        <div class="mb-3">
                            <label for="newPassword" class="form-label">New Password</label>
                            <div class="input-group">
                                <input type="password" class="form-control" id="newPassword" required>
                                <button class="btn btn-outline-secondary" type="button"
                                    onclick="togglePassword('newPassword')">
                                    <i class="fas fa-eye"></i>
                                </button>
                            </div>
                            <div class="form-text">
                                Password must be at least 8 characters with 2 uppercase, 2 lowercase, 2 numbers, and 2
                                special characters.
                            </div>
                            <div id="passwordStrength" class="mt-2"></div>
                        </div>
                        <div class="mb-3">
                            <label for="confirmPassword" class="form-label">Confirm New Password</label>
                            <div class="input-group">
                                <input type="password" class="form-control" id="confirmPassword" required>
                                <button class="btn btn-outline-secondary" type="button"
                                    onclick="togglePassword('confirmPassword')">
                                    <i class="fas fa-eye"></i>
                                </button>
                            </div>
                        </div>
                    </form>
                </div>
                <div class="modal-footer">
                    <button type="button" class="btn btn-secondary" data-bs-dismiss="modal">Cancel</button>
                    <button type="button" class="btn btn-primary" onclick="updatePassword()">
                        <i class="fas fa-save me-2"></i>Update Password
                    </button>
                </div>
            </div>
        </div>
    </div>

    <!-- Update Profile Modal -->
    <div class="modal fade" id="updateProfileModal" tabindex="-1" aria-labelledby="updateProfileModalLabel"
        aria-hidden="true">
        <div class="modal-dialog">
            <div class="modal-content">
                <div class="modal-header">
                    <h5 class="modal-title" id="updateProfileModalLabel">
                        <i class="fas fa-user-edit me-2"></i>Update Profile
                    </h5>
                    <button type="button" class="btn-close" data-bs-dismiss="modal" aria-label="Close"></button>
                </div>
                <div class="modal-body">
                    <div id="profileUpdateMessage" class="alert" style="display: none;"></div>
                    <form id="updateProfileForm">
                        <div class="mb-3">
                            <label for="profileUsername" class="form-label">Full Name</label>
                            <input type="text" class="form-control" id="profileUsername" required readonly>
                        </div>
                        <div class="mb-3">
                            <label for="profileEmail" class="form-label">Email</label>
                            <input type="email" class="form-control" id="profileEmail" required readonly>
                        </div>
                        <div class="mb-3">
                            <label for="profileCompany" class="form-label">Company</label>
                            <input type="text" class="form-control" id="profileCompany" readonly>
                        </div>
                        <div class="mb-3">
                            <label for="profilePhone" class="form-label">Phone Number</label>
                            <input type="tel" class="form-control" id="profilePhone">
                        </div>

                        <div class="mb-3">
                            <label for="profileRemark" class="form-label">Remark (required for any update)</label>
                            <textarea id="profileRemark" class="form-control"
                                placeholder="Add a short remark describing the update" required></textarea>
                        </div>

                        <div class="mb-2 small text-muted">
                            <div>Profile last updated: <span id="profileUpdatedAt">-</span></div>
                            <div>Password last updated: <span id="passwordUpdatedAt">-</span></div>
                        </div>
                    </form>
                </div>
                <div class="modal-footer">
                    <button type="button" class="btn btn-secondary" data-bs-dismiss="modal">Cancel</button>
                    <button type="button" class="btn btn-primary" onclick="updateProfile()">
                        <i class="fas fa-save me-2"></i>Update Profile
                    </button>
                </div>
            </div>
        </div>
    </div>

    <script src="../theme.js"></script>
    <script type="module" src="approver.js"></script>
    <!-- Bootstrap 5 JS Bundle (with Popper) -->
    <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.2/dist/js/bootstrap.bundle.min.js"></script>
</body>

</html>