<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Dasher UI - Approver Dashboard</title>
    <link rel="stylesheet" href="../theme.css">
    <link rel="stylesheet" href="kaiadmin.css">
    <link rel="stylesheet" href="approver.css">
    <link href="https://fonts.googleapis.com/css?family=Inter:400,500,600,700&display=swap" rel="stylesheet">
    <!-- Bootstrap 5 CSS -->
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.2/dist/css/bootstrap.min.css" rel="stylesheet">
    <!-- Font Awesome 5 -->
    <link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.15.4/css/all.min.css" rel="stylesheet">
    <!-- Chart.js -->
    <script src="https://cdn.jsdelivr.net/npm/chart.js@4.4.1/dist/chart.umd.min.js"></script>
    <!-- XLSX for Excel export -->
    <script src="https://cdnjs.cloudflare.com/ajax/libs/xlsx/0.18.5/xlsx.full.min.js"></script>
</head>

<body class="dasher-bg">
    <!-- Sidebar Trigger Button moved to header next to search box -->
    <!-- Sidebar -->
    <nav id="sidebar" class="sidebar bg-white border-end position-fixed top-0 start-0 vh-100 d-flex flex-column">
        <div class="sidebar-logo p-3 border-bottom text-center">
            <img src="../images/HIA_logo.png" alt="HIA Logo" class="mb-2"
                style="height: 60px; max-width: 100%; object-fit: contain;">
        </div>

        <!-- Profile Section -->
        <div class="sidebar-profile p-3 border-bottom">
            <div class="profile-info">
                <div class="profile-avatar text-center mb-2">
                    <div class="avatar-circle bg-primary text-white d-inline-flex align-items-center justify-content-center rounded-circle"
                        style="width: 50px; height: 50px; font-size: 18px; font-weight: 600;">
                        AH
                    </div>
                </div>
                <div class="profile-details text-center">
                    <h6 class="profile-name mb-1 fw-bold text-dark">Ahmed Hizrian</h6>
                    <p class="profile-email mb-1 text-muted small">ahmed.hizrian@hia.gov.ae</p>
                    <p class="profile-contact mb-1 text-muted small">+971 50 123 4567</p>
                    <p class="last-login mb-0 text-muted" style="font-size: 11px;">
                        Last Login: Monday, at 14:35:22
                    </p>
                </div>
            </div>
        </div>

        <!-- Account Settings Section -->
        <div class="sidebar-settings p-3 border-bottom">
            <h6 class="settings-title mb-3 text-muted small text-uppercase fw-bold">Account Settings</h6>
            <div class="settings-items">
                <!-- Theme Toggle -->
                <div class="setting-item d-flex align-items-center justify-content-center mb-3">
                    <div class="theme-toggle-container">
                        <div class="theme-slider" id="themeSlider">
                            <div class="theme-option left active" id="lightTheme">
                                <i class="fas fa-sun"></i>
                            </div>
                            <div class="theme-option right" id="darkTheme">
                                <i class="fas fa-moon"></i>
                            </div>
                            <div class="slider-background"></div>
                        </div>
                    </div>
                </div>

                <!-- Update Profile -->
                <div class="setting-item d-flex align-items-center mb-2">
                    <div class="d-flex align-items-center gap-2 flex-grow-1">
                        <i class="fas fa-user-edit text-muted" style="width: 16px;"></i>
                        <a href="#" class="setting-link small text-decoration-none text-dark"
                            onclick="showUpdateProfileModal()">Update Profile</a>
                    </div>
                </div>

                <!-- Update Password -->
                <div class="setting-item d-flex align-items-center mb-2">
                    <div class="d-flex align-items-center gap-2 flex-grow-1">
                        <i class="fas fa-key text-muted" style="width: 16px;"></i>
                        <a href="#" class="setting-link small text-decoration-none text-dark"
                            onclick="showUpdatePasswordModal()">Update Password</a>
                    </div>
                </div>
            </div>
        </div>

        <!-- Logout Section -->
        <div class="sidebar-logout p-3 border-bottom">
            <div class="logout-item d-flex align-items-center justify-content-center">
                <div class="d-flex align-items-center gap-2">
                    <i class="fas fa-sign-out-alt text-danger" style="width: 16px;"></i>
                    <a href="#" class="setting-link small text-decoration-none text-danger fw-medium"
                        onclick="confirmLogout()">Logout</a>
                </div>
            </div>
        </div>

        <ul class="nav flex-column nav-secondary mt-3 flex-grow-1">
            <!-- Navigation content will be added here -->
        </ul>
    </nav>
    <div class="kai-main">
        <header class="main-header">
            <nav class="navbar navbar-header navbar-header-transparent navbar-expand-lg border-bottom">
                <div class="container-fluid">
                    <div class="d-flex align-items-center gap-2" style="max-width: 400px;">
                        <button id="sidebarTrigger" class="btn btn-primary" style="z-index:1200;"
                            data-bs-toggle="tooltip" data-bs-placement="right" title="Open Menu">
                            <i class="fas fa-bars"></i>
                        </button>
                        <form class="flex-grow-1">
                            <div class="input-group">
                                <input type="text" placeholder="Search ..." class="form-control" />
                            </div>
                        </form>
                    </div>
                    <ul class="navbar-nav topbar-nav ms-md-auto align-items-center">
                        <!-- Removed message and notification icons -->
                        <li class="nav-item topbar-user dropdown hidden-caret">
                            <span class="profile-username">Hi, <span class="fw-bold">Hizrian</span></span>
                            <ul class="dropdown-menu dropdown-user animated fadeIn">
                                <div class="dropdown-user-scroll scrollbar-outer">
                                    <li>
                                        <div class="user-box">
                                            <div class="avatar-lg"><img
                                                    src="https://ui-avatars.com/api/?name=Approver&background=2563eb&color=fff&size=40"
                                                    alt="image profile" class="avatar-img rounded" /></div>
                                            <div class="u-text">
                                                <h4>Approver</h4>
                                                <p class="text-muted">approver@example.com</p>
                                                <a href="#" class="btn btn-xs btn-secondary btn-sm">View Profile</a>
                                            </div>
                                        </div>
                                    </li>
                                    <li>
                                        <div class="dropdown-divider"></div>
                                        <a class="dropdown-item" href="#">My Profile</a>
                                        <a class="dropdown-item" href="#">Inbox</a>
                                        <div class="dropdown-divider"></div>
                                        <a class="dropdown-item" href="#">Account Setting</a>
                                        <div class="dropdown-divider"></div>
                                        <a class="dropdown-item" href="#">Logout</a>
                                    </li>
                                </div>
                            </ul>
                        </li>
                    </ul>
                </div>
            </nav>
        </header>
        <main class="kai-content">
            <!-- Dashboard Cards Row - Permit Stats and Percentages -->
            <div class="row g-4 mb-4">
                <!-- Total Permits -->
                <div class="col-12 col-sm-6 col-md-4">
                    <div class="card card-stats card-round h-100 shadow-sm">
                        <div class="card-body d-flex align-items-center gap-3">
                            <div class="icon-big text-center rounded-3 d-flex align-items-center justify-content-center"
                                style="background:#1769ff;width:80px;height:80px;">
                                <i class="fas fa-file-alt fa-2x text-white"></i>
                            </div>
                            <div>
                                <p class="card-category mb-1 text-muted">Total Permits</p>
                                <h4 id="totalPermitsCount" class="card-title mb-0 fw-bold" style="color:#2d3651;">0</h4>
                            </div>
                        </div>
                    </div>
                </div>
                <!-- Approved Permits -->
                <div class="col-12 col-sm-6 col-md-4">
                    <div class="card card-stats card-round h-100 shadow-sm">
                        <div class="card-body d-flex align-items-center gap-3">
                            <div class="icon-big text-center rounded-3 d-flex align-items-center justify-content-center"
                                style="background:#22c55e;width:80px;height:80px;">
                                <i class="fas fa-check-circle fa-2x text-white"></i>
                            </div>
                            <div>
                                <p class="card-category mb-1 text-muted">Approved Permits</p>
                                <h4 id="approvedPermitsCount" class="card-title mb-0 fw-bold" style="color:#2d3651;">0
                                </h4>
                            </div>
                        </div>
                    </div>
                </div>
                <!-- Approved % -->
                <div class="col-12 col-sm-6 col-md-4">
                    <div class="card card-stats card-round h-100 shadow-sm">
                        <div class="card-body d-flex align-items-center gap-3">
                            <div class="icon-big text-center rounded-3 d-flex align-items-center justify-content-center"
                                style="background:#22c55e;width:80px;height:80px;">
                                <i class="fas fa-percentage fa-2x text-white"></i>
                            </div>
                            <div>
                                <p class="card-category mb-1 text-muted">Approved %</p>
                                <h4 class="card-title mb-0 fw-bold" style="color:#2d3651;">77.5%</h4>
                            </div>
                        </div>
                    </div>
                </div>
                <!-- Rejected Permits -->
                <div class="col-12 col-sm-6 col-md-4">
                    <div class="card card-stats card-round h-100 shadow-sm">
                        <div class="card-body d-flex align-items-center gap-3">
                            <div class="icon-big text-center rounded-3 d-flex align-items-center justify-content-center"
                                style="background:#ef4444;width:80px;height:80px;">
                                <i class="fas fa-times-circle fa-2x text-white"></i>
                            </div>
                            <div>
                                <p class="card-category mb-1 text-muted">Rejected Permits</p>
                                <h4 id="rejectedPermitsCount" class="card-title mb-0 fw-bold" style="color:#2d3651;">0
                                </h4>
                            </div>
                        </div>
                    </div>
                </div>
                <!-- Rejected % -->
                <div class="col-12 col-sm-6 col-md-4">
                    <div class="card card-stats card-round h-100 shadow-sm">
                        <div class="card-body d-flex align-items-center gap-3">
                            <div class="icon-big text-center rounded-3 d-flex align-items-center justify-content-center"
                                style="background:#ef4444;width:80px;height:80px;">
                                <i class="fas fa-percentage fa-2x text-white"></i>
                            </div>
                            <div>
                                <p class="card-category mb-1 text-muted">Rejected %</p>
                                <h4 class="card-title mb-0 fw-bold" style="color:#2d3651;">9.3%</h4>
                            </div>
                        </div>
                    </div>
                </div>
                <!-- Pending Permits -->
                <div class="col-12 col-sm-6 col-md-4">
                    <div class="card card-stats card-round h-100 shadow-sm">
                        <div class="card-body d-flex align-items-center gap-3">
                            <div class="icon-big text-center rounded-3 d-flex align-items-center justify-content-center"
                                style="background:#8b5cf6;width:80px;height:80px;">
                                <i class="fas fa-hourglass-half fa-2x text-white"></i>
                            </div>
                            <div>
                                <p class="card-category mb-1 text-muted">Pending Permits</p>
                                <h4 id="pendingPermitsCount" class="card-title mb-0 fw-bold" style="color:#2d3651;">0
                                </h4>
                            </div>
                        </div>
                    </div>
                </div>
                <!-- Pending % -->
                <div class="col-12 col-sm-6 col-md-4">
                    <div class="card card-stats card-round h-100 shadow-sm">
                        <div class="card-body d-flex align-items-center gap-3">
                            <div class="icon-big text-center rounded-3 d-flex align-items-center justify-content-center"
                                style="background:#8b5cf6;width:80px;height:80px;">
                                <i class="fas fa-percentage fa-2x text-white"></i>
                            </div>
                            <div>
                                <p class="card-category mb-1 text-muted">Pending %</p>
                                <h4 class="card-title mb-0 fw-bold" style="color:#2d3651;">9.7%</h4>
                            </div>
                        </div>
                    </div>
                </div>
                <!-- Returned for Info -->
                <div class="col-12 col-sm-6 col-md-4">
                    <div class="card card-stats card-round h-100 shadow-sm">
                        <div class="card-body d-flex align-items-center gap-3">
                            <div class="icon-big text-center rounded-3 d-flex align-items-center justify-content-center"
                                style="background:#f59e42;width:80px;height:80px;">
                                <i class="fas fa-info-circle fa-2x text-white"></i>
                            </div>
                            <div>
                                <p class="card-category mb-1 text-muted">Returned for Info</p>
                                <h4 class="card-title mb-0 fw-bold" style="color:#2d3651;">45</h4>
                            </div>
                        </div>
                    </div>
                </div>
                <!-- Returned % -->
                <div class="col-12 col-sm-6 col-md-4">
                    <div class="card card-stats card-round h-100 shadow-sm">
                        <div class="card-body d-flex align-items-center gap-3">
                            <div class="icon-big text-center rounded-3 d-flex align-items-center justify-content-center"
                                style="background:#f59e42;width:80px;height:80px;">
                                <i class="fas fa-percentage fa-2x text-white"></i>
                            </div>
                            <div>
                                <p class="card-category mb-1 text-muted">Returned %</p>
                                <h4 class="card-title mb-0 fw-bold" style="color:#2d3651;">3.5%</h4>
                            </div>
                        </div>
                    </div>
                </div>
            </div>

            <!-- Task Progress Widget and Permit Lists -->
            <div class="row mt-4 mb-4">
                <!-- Task Progress Widget -->
                <div class="col-12 col-md-6 col-lg-4">
                    <div class="card card-round shadow-sm h-100">
                        <div class="card-body p-4">
                            <h5 class="card-title mb-4 fw-bold text-dark">Task Progress</h5>

                            <!-- Overall Progress -->
                            <div class="progress-summary mb-4">
                                <h2 class="progress-percentage mb-2 fw-bold text-dark">64%</h2>
                                <div class="progress-bar-container mb-3">
                                    <div class="progress" style="height: 8px; background: #f1f5f9;">
                                        <div class="progress-bar bg-info"
                                            style="width: 24%; background: linear-gradient(90deg, #06b6d4, #0891b2) !important;">
                                        </div>
                                        <div class="progress-bar bg-success"
                                            style="width: 35%; background: linear-gradient(90deg, #10b981, #059669) !important;">
                                        </div>
                                        <div class="progress-bar bg-warning"
                                            style="width: 41%; background: linear-gradient(90deg, #f59e0b, #d97706) !important;">
                                        </div>
                                    </div>
                                </div>
                                <div class="progress-labels d-flex justify-content-between small text-muted">
                                    <span>24%</span>
                                    <span>35%</span>
                                    <span>41%</span>
                                </div>
                            </div>

                            <!-- Task Status Items -->
                            <div class="task-status-grid">
                                <div class="task-status-item text-center mb-3">
                                    <div class="task-icon mx-auto mb-2 d-flex align-items-center justify-content-center rounded-circle"
                                        style="width: 50px; height: 50px; background: rgba(6, 182, 212, 0.1);">
                                        <i class="fas fa-check-circle text-info"
                                            style="font-size: 18px; color: #06b6d4 !important;"></i>
                                    </div>
                                    <h4 class="task-number mb-1 fw-bold text-dark">8</h4>
                                    <p class="task-label small text-muted mb-0">Completed</p>
                                </div>

                                <div class="task-status-item text-center mb-3">
                                    <div class="task-icon mx-auto mb-2 d-flex align-items-center justify-content-center rounded-circle"
                                        style="width: 50px; height: 50px; background: rgba(16, 185, 129, 0.1);">
                                        <i class="fas fa-spinner text-success"
                                            style="font-size: 18px; color: #10b981 !important;"></i>
                                    </div>
                                    <h4 class="task-number mb-1 fw-bold text-dark">12</h4>
                                    <p class="task-label small text-muted mb-0">In-Progress</p>
                                </div>

                                <div class="task-status-item text-center mb-3">
                                    <div class="task-icon mx-auto mb-2 d-flex align-items-center justify-content-center rounded-circle"
                                        style="width: 50px; height: 50px; background: rgba(245, 158, 11, 0.1);">
                                        <i class="fas fa-clock text-warning"
                                            style="font-size: 18px; color: #f59e0b !important;"></i>
                                    </div>
                                    <h4 class="task-number mb-1 fw-bold text-dark">14</h4>
                                    <p class="task-label small text-muted mb-0">Up Coming</p>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>

                <!-- Approved Permits -->
                <div class="col-12 col-md-6 col-lg-4">
                    <div class="card card-round shadow-sm h-100">
                        <div class="card-header border-bottom">
                            <h5 class="card-title mb-0 fw-bold text-dark">Approved Permits</h5>
                        </div>
                        <div class="card-body">
                            <!-- Table content will be added here -->
                            <div class="table-responsive">
                                <table class="table table-sm">
                                    <thead>
                                        <tr>
                                            <th class="small text-muted">Permit ID</th>
                                            <th class="small text-muted">Status</th>
                                        </tr>
                                    </thead>
                                    <tbody>
                                        <!-- Table data will be populated here -->
                                    </tbody>
                                </table>
                            </div>
                        </div>
                    </div>
                </div>

                <!-- Rejected Permits -->
                <div class="col-12 col-md-6 col-lg-4">
                    <div class="card card-round shadow-sm h-100">
                        <div class="card-header border-bottom">
                            <h5 class="card-title mb-0 fw-bold text-dark">Rejected Permits</h5>
                        </div>
                        <div class="card-body">
                            <!-- Table content will be added here -->
                            <div class="table-responsive">
                                <table class="table table-sm">
                                    <thead>
                                        <tr>
                                            <th class="small text-muted">Permit ID</th>
                                            <th class="small text-muted">Status</th>
                                        </tr>
                                    </thead>
                                    <tbody>
                                        <!-- Table data will be populated here -->
                                    </tbody>
                                </table>
                            </div>
                        </div>
                    </div>
                </div>
            </div>

            <!-- Statistics and Widgets Row -->
            <div class="row mt-4">
                <div class="col-12">
                    <div class="card card-round mb-3">
                        <div class="card-header">
                            <div class="card-head-row">
                                <div class="card-title">
                                    <h5 class="mb-0 fw-bold">Total Pending Permits</h5>
                                    <small class="text-muted">Review and process pending permit applications</small>
                                </div>
                                <div class="card-tools">
                                    <div class="dropdown">
                                        <button class="btn btn-success btn-sm dropdown-toggle me-2" type="button"
                                            id="exportDropdown" data-bs-toggle="dropdown" aria-expanded="false">
                                            <i class="fas fa-download me-1"></i>Export
                                        </button>
                                        <ul class="dropdown-menu" aria-labelledby="exportDropdown">
                                            <li><a class="dropdown-item" href="#" onclick="exportToCSV()"><i
                                                        class="fas fa-file-csv me-2"></i>Export to CSV</a></li>
                                            <li><a class="dropdown-item" href="#" onclick="exportToExcel()"><i
                                                        class="fas fa-file-excel me-2"></i>Export to Excel</a></li>
                                        </ul>
                                    </div>
                                    <button class="btn btn-info btn-sm" onclick="printTable()">
                                        <i class="fas fa-print me-1"></i>Print
                                    </button>
                                </div>
                            </div>
                        </div>
                        <div class="card-body">
                            <div class="table-responsive">
                                <table id="pendingPermitsTable" class="table table-hover">
                                    <thead class="table-light">
                                        <tr>
                                            <th class="text-center table-header-dynamic" data-field="serialNo">
                                                <div class="header-content">
                                                    <i class="fas fa-hashtag me-2"></i>
                                                    <span>Serial No.</span>
                                                </div>
                                            </th>
                                            <th class="text-center table-header-dynamic" data-field="permitTitle">
                                                <div class="header-content">
                                                    <i class="fas fa-file-contract me-2"></i>
                                                    <span>Permit Title</span>
                                                </div>
                                            </th>
                                            <th class="text-center table-header-dynamic" data-field="submittedDateTime">
                                                <div class="header-content">
                                                    <i class="fas fa-calendar-alt me-2"></i>
                                                    <span>Submitted Date & Time</span>
                                                </div>
                                            </th>
                                            <th class="text-center table-header-dynamic" data-field="preApproverName">
                                                <div class="header-content">
                                                    <i class="fas fa-user-check me-2"></i>
                                                    <span>Pre Approver Name</span>
                                                </div>
                                            </th>
                                            <th class="text-center table-header-dynamic"
                                                data-field="preApproverRemarks">
                                                <div class="header-content">
                                                    <i class="fas fa-comment-alt me-2"></i>
                                                    <span>Pre Approver Remarks</span>
                                                </div>
                                            </th>
                                            <th class="text-center table-header-dynamic" data-field="actions">
                                                <div class="header-content">
                                                    <i class="fas fa-cogs me-2"></i>
                                                    <span>Actions</span>
                                                </div>
                                            </th>
                                        </tr>
                                    </thead>
                                    <tbody>
                                        <!-- Comprehensive Pending Permits Data -->
                                        <tr>
                                            <td class="small">PTW-001</td>
                                            <td class="small fw-medium">Construction Work Permit - Al Ain Tower</td>
                                            <td class="small">07/10/2025, 14:30</td>
                                            <td class="small">Ahmed Hassan Al-Mahmoud</td>
                                            <td class="small">Safety documentation verified, site inspection completed
                                            </td>
                                            <td class="small">
                                                <div class="btn-group" role="group">
                                                    <button type="button" class="btn btn-outline-primary btn-sm"
                                                        title="View Details">
                                                        <i class="fas fa-search"></i>
                                                    </button>
                                                    <button type="button" class="btn btn-outline-success btn-sm"
                                                        title="Approve">
                                                        <i class="fas fa-check-circle"></i>
                                                    </button>
                                                    <button type="button" class="btn btn-outline-danger btn-sm"
                                                        title="Reject">
                                                        <i class="fas fa-times-circle"></i>
                                                    </button>
                                                    <button type="button" class="btn btn-outline-warning btn-sm"
                                                        title="Request More Info">
                                                        <i class="fas fa-question-circle"></i>
                                                    </button>
                                                </div>
                                            </td>
                                        </tr>
                                        <tr>
                                            <td class="small">PTW-002</td>
                                            <td class="small fw-medium">Environmental Permit - Industrial Waste
                                                Management</td>
                                            <td class="small">07/10/2025, 12:15</td>
                                            <td class="small">Dr. Sarah Al-Mansouri</td>
                                            <td class="small">Environmental impact assessment reviewed, minor
                                                adjustments needed</td>
                                            <td class="small">
                                                <div class="btn-group" role="group">
                                                    <button type="button" class="btn btn-outline-primary btn-sm"
                                                        title="View Details">
                                                        <i class="fas fa-search"></i>
                                                    </button>
                                                    <button type="button" class="btn btn-outline-success btn-sm"
                                                        title="Approve">
                                                        <i class="fas fa-check-circle"></i>
                                                    </button>
                                                    <button type="button" class="btn btn-outline-danger btn-sm"
                                                        title="Reject">
                                                        <i class="fas fa-times-circle"></i>
                                                    </button>
                                                    <button type="button" class="btn btn-outline-warning btn-sm"
                                                        title="Request Info">
                                                        <i class="fas fa-question-circle"></i>
                                                    </button>
                                                </div>
                                            </td>
                                        </tr>
                                        <tr>
                                            <td class="small">PTW-003</td>
                                            <td class="small fw-medium">Trade License Renewal - Emirates Trading LLC
                                            </td>
                                            <td class="small">07/10/2025, 09:45</td>
                                            <td class="small">Mohammad Khalil Ibrahim</td>
                                            <td class="small">All compliance requirements met, financial documents
                                                verified</td>
                                            <td class="small">
                                                <div class="btn-group" role="group">
                                                    <button type="button" class="btn btn-outline-primary btn-sm"
                                                        title="View Details">
                                                        <i class="fas fa-search"></i>
                                                    </button>
                                                    <button type="button" class="btn btn-outline-success btn-sm"
                                                        title="Approve">
                                                        <i class="fas fa-check-circle"></i>
                                                    </button>
                                                    <button type="button" class="btn btn-outline-danger btn-sm"
                                                        title="Reject">
                                                        <i class="fas fa-times-circle"></i>
                                                    </button>
                                                    <button type="button" class="btn btn-outline-warning btn-sm"
                                                        title="Request Info">
                                                        <i class="fas fa-question-circle"></i>
                                                    </button>
                                                </div>
                                            </td>
                                        </tr>
                                        <tr>
                                            <td class="small">PTW-004</td>
                                            <td class="small fw-medium">Fire Safety Certificate - Mall Extension</td>
                                            <td class="small">06/10/2025, 16:20</td>
                                            <td class="small">Eng. Fatima Al-Zahra</td>
                                            <td class="small">Fire safety systems installed, emergency exits approved
                                            </td>
                                            <td class="small">
                                                <div class="btn-group" role="group">
                                                    <button type="button" class="btn btn-outline-primary btn-sm"
                                                        title="View Details">
                                                        <i class="fas fa-search"></i>
                                                    </button>
                                                    <button type="button" class="btn btn-outline-success btn-sm"
                                                        title="Approve">
                                                        <i class="fas fa-check-circle"></i>
                                                    </button>
                                                    <button type="button" class="btn btn-outline-danger btn-sm"
                                                        title="Reject">
                                                        <i class="fas fa-times-circle"></i>
                                                    </button>
                                                    <button type="button" class="btn btn-outline-warning btn-sm"
                                                        title="Request Info">
                                                        <i class="fas fa-question-circle"></i>
                                                    </button>
                                                </div>
                                            </td>
                                        </tr>
                                        <tr>
                                            <td class="small">PTW-005</td>
                                            <td class="small fw-medium">Excavation Permit - Dubai Metro Line Extension
                                            </td>
                                            <td class="small">06/10/2025, 13:50</td>
                                            <td class="small">Khalid Al-Rashid</td>
                                            <td class="small">Utility clearance obtained, traffic management plan
                                                approved</td>
                                            <td class="small">
                                                <div class="btn-group" role="group">
                                                    <button type="button" class="btn btn-outline-primary btn-sm"
                                                        title="View Details">
                                                        <i class="fas fa-search"></i>
                                                    </button>
                                                    <button type="button" class="btn btn-outline-success btn-sm"
                                                        title="Approve">
                                                        <i class="fas fa-check-circle"></i>
                                                    </button>
                                                    <button type="button" class="btn btn-outline-danger btn-sm"
                                                        title="Reject">
                                                        <i class="fas fa-times-circle"></i>
                                                    </button>
                                                    <button type="button" class="btn btn-outline-warning btn-sm"
                                                        title="Request Info">
                                                        <i class="fas fa-question-circle"></i>
                                                    </button>
                                                </div>
                                            </td>
                                        </tr>
                                        <tr>
                                            <td class="small">PTW-006</td>
                                            <td class="small fw-medium">Food Service License - Jumeirah Beach Restaurant
                                            </td>
                                            <td class="small">06/10/2025, 11:30</td>
                                            <td class="small">Amina Youssef</td>
                                            <td class="small">Health inspection passed, kitchen facilities meet
                                                standards</td>
                                            <td class="small">
                                                <div class="btn-group" role="group">
                                                    <button type="button" class="btn btn-outline-primary btn-sm"
                                                        title="View Details">
                                                        <i class="fas fa-search"></i>
                                                    </button>
                                                    <button type="button" class="btn btn-outline-success btn-sm"
                                                        title="Approve">
                                                        <i class="fas fa-check-circle"></i>
                                                    </button>
                                                    <button type="button" class="btn btn-outline-danger btn-sm"
                                                        title="Reject">
                                                        <i class="fas fa-times-circle"></i>
                                                    </button>
                                                    <button type="button" class="btn btn-outline-warning btn-sm"
                                                        title="Request Info">
                                                        <i class="fas fa-question-circle"></i>
                                                    </button>
                                                </div>
                                            </td>
                                        </tr>
                                        <tr>
                                            <td class="small">PTW-007</td>
                                            <td class="small fw-medium">Signage Installation Permit - Business Bay
                                                District</td>
                                            <td class="small">05/10/2025, 15:45</td>
                                            <td class="small">Omar Al-Suwaidi</td>
                                            <td class="small">Design approved, structural assessment completed</td>
                                            <td class="small">
                                                <div class="btn-group" role="group">
                                                    <button type="button" class="btn btn-outline-primary btn-sm"
                                                        title="View Details">
                                                        <i class="fas fa-search"></i>
                                                    </button>
                                                    <button type="button" class="btn btn-outline-success btn-sm"
                                                        title="Approve">
                                                        <i class="fas fa-check-circle"></i>
                                                    </button>
                                                    <button type="button" class="btn btn-outline-danger btn-sm"
                                                        title="Reject">
                                                        <i class="fas fa-times-circle"></i>
                                                    </button>
                                                    <button type="button" class="btn btn-outline-warning btn-sm"
                                                        title="Request Info">
                                                        <i class="fas fa-question-circle"></i>
                                                    </button>
                                                </div>
                                            </td>
                                        </tr>
                                        <tr>
                                            <td class="small">PTW-008</td>
                                            <td class="small fw-medium">Telecommunications Installation - 5G Tower</td>
                                            <td class="small">05/10/2025, 10:20</td>
                                            <td class="small">Eng. Rashid Al-Maktoum</td>
                                            <td class="small">RF emission tests completed, community consultation done
                                            </td>
                                            <td class="small">
                                                <div class="btn-group" role="group">
                                                    <button type="button" class="btn btn-outline-primary btn-sm"
                                                        title="View Details">
                                                        <i class="fas fa-search"></i>
                                                    </button>
                                                    <button type="button" class="btn btn-outline-success btn-sm"
                                                        title="Approve">
                                                        <i class="fas fa-check-circle"></i>
                                                    </button>
                                                    <button type="button" class="btn btn-outline-danger btn-sm"
                                                        title="Reject">
                                                        <i class="fas fa-times-circle"></i>
                                                    </button>
                                                    <button type="button" class="btn btn-outline-warning btn-sm"
                                                        title="Request Info">
                                                        <i class="fas fa-question-circle"></i>
                                                    </button>
                                                </div>
                                            </td>
                                        </tr>
                                    </tbody>
                                </table>
                            </div>
                        </div>
                    </div>
                </div>

                <!-- Approved Permits Table -->
                <div class="col-12 mt-4">
                    <div class="card card-round mb-3">
                        <div class="card-header">
                            <div class="card-head-row">
                                <div class="card-title">
                                    <h5 class="mb-0 fw-bold">Approved Permits</h5>
                                    <small class="text-muted">View all approved permit applications</small>
                                </div>
                                <div class="card-tools">
                                    <div class="dropdown">
                                        <button class="btn btn-success btn-sm dropdown-toggle me-2" type="button"
                                            id="approvedExportDropdown" data-bs-toggle="dropdown" aria-expanded="false">
                                            <i class="fas fa-download me-1"></i>Export
                                        </button>
                                        <ul class="dropdown-menu" aria-labelledby="approvedExportDropdown">
                                            <li><a class="dropdown-item" href="#" onclick="exportApprovedToCSV()"><i
                                                        class="fas fa-file-csv me-2"></i>Export to CSV</a></li>
                                            <li><a class="dropdown-item" href="#" onclick="exportApprovedToExcel()"><i
                                                        class="fas fa-file-excel me-2"></i>Export to Excel</a></li>
                                        </ul>
                                    </div>
                                    <button class="btn btn-info btn-sm" onclick="printApprovedTable()">
                                        <i class="fas fa-print me-1"></i>Print
                                    </button>
                                </div>
                            </div>
                        </div>
                        <div class="card-body">
                            <div class="table-responsive">
                                <table id="approvedPermitsTable" class="table table-hover">
                                    <thead class="table-light">
                                        <tr>
                                            <th class="text-center table-header-dynamic" data-field="permitNumber">
                                                <div class="header-content">
                                                    <i class="fas fa-certificate me-2"></i>
                                                    <span>Permit Number</span>
                                                </div>
                                            </th>
                                            <th class="text-center table-header-dynamic" data-field="permitTitle">
                                                <div class="header-content">
                                                    <i class="fas fa-file-contract me-2"></i>
                                                    <span>Permit Title</span>
                                                </div>
                                            </th>
                                            <th class="text-center table-header-dynamic" data-field="submittedDateTime">
                                                <div class="header-content">
                                                    <i class="fas fa-calendar-alt me-2"></i>
                                                    <span>Submitted Date & Time</span>
                                                </div>
                                            </th>
                                            <th class="text-center table-header-dynamic" data-field="preApproverName">
                                                <div class="header-content">
                                                    <i class="fas fa-user-check me-2"></i>
                                                    <span>Pre Approver Name</span>
                                                </div>
                                            </th>
                                            <th class="text-center table-header-dynamic"
                                                data-field="preApproverDecision">
                                                <div class="header-content">
                                                    <i class="fas fa-gavel me-2"></i>
                                                    <span>Pre Approver Decision</span>
                                                </div>
                                            </th>
                                            <th class="text-center table-header-dynamic"
                                                data-field="preApproverDateTime">
                                                <div class="header-content">
                                                    <i class="fas fa-clock me-2"></i>
                                                    <span>Pre Approver Date & Time</span>
                                                </div>
                                            </th>
                                            <th class="text-center table-header-dynamic"
                                                data-field="preApproverRemarks">
                                                <div class="header-content">
                                                    <i class="fas fa-comment-alt me-2"></i>
                                                    <span>Pre Approver Remarks</span>
                                                </div>
                                            </th>
                                            <th class="text-center table-header-dynamic" data-field="approverDecision">
                                                <div class="header-content">
                                                    <i class="fas fa-stamp me-2"></i>
                                                    <span>Approver Decision</span>
                                                </div>
                                            </th>
                                            <th class="text-center table-header-dynamic" data-field="approverDateTime">
                                                <div class="header-content">
                                                    <i class="fas fa-history me-2"></i>
                                                    <span>Approver Date & Time</span>
                                                </div>
                                            </th>
                                            <th class="text-center table-header-dynamic" data-field="approverRemarks">
                                                <div class="header-content">
                                                    <i class="fas fa-comments me-2"></i>
                                                    <span>Approver Remarks</span>
                                                </div>
                                            </th>
                                            <th class="text-center table-header-dynamic" data-field="permitStatus">
                                                <div class="header-content">
                                                    <i class="fas fa-flag me-2"></i>
                                                    <span>Permit Status</span>
                                                </div>
                                            </th>
                                        </tr>
                                    </thead>
                                    <tbody>
                                        <!-- Approved Permits Data -->
                                        <tr>
                                            <td class="small">PTW-A001</td>
                                            <td class="small fw-medium">Construction Work Permit - Marina Plaza</td>
                                            <td class="small">05/10/2025, 11:20</td>
                                            <td class="small">Ahmed Hassan Al-Mahmoud</td>
                                            <td class="small"><span class="badge bg-success">Approved</span></td>
                                            <td class="small">05/10/2025, 15:45</td>
                                            <td class="small">All safety protocols verified, site inspection passed</td>
                                            <td class="small"><span class="badge bg-success">Final Approved</span></td>
                                            <td class="small">06/10/2025, 10:30</td>
                                            <td class="small">Construction permit granted with all conditions met</td>
                                            <td class="small"><span class="badge bg-success">Active</span></td>
                                        </tr>
                                        <tr>
                                            <td class="small">PTW-A002</td>
                                            <td class="small fw-medium">Trade License - Gulf Trading Co.</td>
                                            <td class="small">04/10/2025, 09:15</td>
                                            <td class="small">Dr. Sarah Al-Mansouri</td>
                                            <td class="small"><span class="badge bg-success">Approved</span></td>
                                            <td class="small">04/10/2025, 16:20</td>
                                            <td class="small">Financial documentation complete, compliance verified</td>
                                            <td class="small"><span class="badge bg-success">Final Approved</span></td>
                                            <td class="small">05/10/2025, 11:45</td>
                                            <td class="small">License approved for 3-year period</td>
                                            <td class="small"><span class="badge bg-success">Active</span></td>
                                        </tr>
                                        <tr>
                                            <td class="small">PTW-A003</td>
                                            <td class="small fw-medium">Environmental Clearance - Solar Farm Project
                                            </td>
                                            <td class="small">03/10/2025, 14:30</td>
                                            <td class="small">Eng. Mohammad Khalil</td>
                                            <td class="small"><span class="badge bg-success">Approved</span></td>
                                            <td class="small">03/10/2025, 17:10</td>
                                            <td class="small">Environmental impact assessment satisfactory</td>
                                            <td class="small"><span class="badge bg-success">Final Approved</span></td>
                                            <td class="small">04/10/2025, 09:25</td>
                                            <td class="small">Project approved with environmental monitoring conditions
                                            </td>
                                            <td class="small"><span class="badge bg-success">Active</span></td>
                                        </tr>
                                    </tbody>
                                </table>
                            </div>
                        </div>
                    </div>
                </div>

                <!-- Rejected Permits Table -->
                <div class="col-12 mt-4">
                    <div class="card card-round mb-3">
                        <div class="card-header">
                            <div class="card-head-row">
                                <div class="card-title">
                                    <h5 class="mb-0 fw-bold">Rejected Permits</h5>
                                    <small class="text-muted">View all rejected permit applications</small>
                                </div>
                                <div class="card-tools">
                                    <div class="dropdown">
                                        <button class="btn btn-danger btn-sm dropdown-toggle me-2" type="button"
                                            id="rejectedExportDropdown" data-bs-toggle="dropdown" aria-expanded="false">
                                            <i class="fas fa-download me-1"></i>Export
                                        </button>
                                        <ul class="dropdown-menu" aria-labelledby="rejectedExportDropdown">
                                            <li><a class="dropdown-item" href="#" onclick="exportRejectedToCSV()"><i
                                                        class="fas fa-file-csv me-2"></i>Export to CSV</a></li>
                                            <li><a class="dropdown-item" href="#" onclick="exportRejectedToExcel()"><i
                                                        class="fas fa-file-excel me-2"></i>Export to Excel</a></li>
                                        </ul>
                                    </div>
                                    <button class="btn btn-info btn-sm" onclick="printRejectedTable()">
                                        <i class="fas fa-print me-1"></i>Print
                                    </button>
                                </div>
                            </div>
                        </div>
                        <div class="card-body">
                            <div class="table-responsive">
                                <table id="rejectedPermitsTable" class="table table-hover">
                                    <thead class="table-light">
                                        <tr>
                                            <th class="text-center table-header-dynamic" data-field="permitNumber">
                                                <div class="header-content">
                                                    <i class="fas fa-certificate me-2"></i>
                                                    <span>Permit Number</span>
                                                </div>
                                            </th>
                                            <th class="text-center table-header-dynamic" data-field="permitTitle">
                                                <div class="header-content">
                                                    <i class="fas fa-file-contract me-2"></i>
                                                    <span>Permit Title</span>
                                                </div>
                                            </th>
                                            <th class="text-center table-header-dynamic" data-field="submittedDateTime">
                                                <div class="header-content">
                                                    <i class="fas fa-calendar-alt me-2"></i>
                                                    <span>Submitted Date & Time</span>
                                                </div>
                                            </th>
                                            <th class="text-center table-header-dynamic" data-field="preApproverName">
                                                <div class="header-content">
                                                    <i class="fas fa-user-check me-2"></i>
                                                    <span>Pre Approver Name</span>
                                                </div>
                                            </th>
                                            <th class="text-center table-header-dynamic"
                                                data-field="preApproverDecision">
                                                <div class="header-content">
                                                    <i class="fas fa-gavel me-2"></i>
                                                    <span>Pre Approver Decision</span>
                                                </div>
                                            </th>
                                            <th class="text-center table-header-dynamic"
                                                data-field="preApproverDateTime">
                                                <div class="header-content">
                                                    <i class="fas fa-clock me-2"></i>
                                                    <span>Pre Approver Date & Time</span>
                                                </div>
                                            </th>
                                            <th class="text-center table-header-dynamic"
                                                data-field="preApproverRemarks">
                                                <div class="header-content">
                                                    <i class="fas fa-comment-alt me-2"></i>
                                                    <span>Pre Approver Remarks</span>
                                                </div>
                                            </th>
                                            <th class="text-center table-header-dynamic" data-field="approverDecision">
                                                <div class="header-content">
                                                    <i class="fas fa-stamp me-2"></i>
                                                    <span>Approver Decision</span>
                                                </div>
                                            </th>
                                            <th class="text-center table-header-dynamic" data-field="approverDateTime">
                                                <div class="header-content">
                                                    <i class="fas fa-clock me-2"></i>
                                                    <span>Approver Date & Time</span>
                                                </div>
                                            </th>
                                            <th class="text-center table-header-dynamic" data-field="approverRemarks">
                                                <div class="header-content">
                                                    <i class="fas fa-comments me-2"></i>
                                                    <span>Approver Remarks</span>
                                                </div>
                                            </th>
                                        </tr>
                                    </thead>
                                    <tbody>
                                        <!-- Rejected Permits Data -->
                                        <tr>
                                            <td class="small">PTW-R001</td>
                                            <td class="small fw-medium">Industrial Waste Disposal - Chemical Plant</td>
                                            <td class="small">02/10/2025, 16:45</td>
                                            <td class="small">Dr. Fatima Al-Zahra</td>
                                            <td class="small"><span class="badge bg-danger">Rejected</span></td>
                                            <td class="small">04/10/2025, 08:20</td>
                                            <td class="small">Environmental impact assessment insufficient</td>
                                            <td class="small"><span class="badge bg-danger">Final Rejected</span></td>
                                            <td class="small">05/10/2025, 14:15</td>
                                            <td class="small">Does not meet environmental safety standards</td>
                                        </tr>
                                        <tr>
                                            <td class="small">PTW-R002</td>
                                            <td class="small fw-medium">Building Permit - Unauthorized Extension</td>
                                            <td class="small">01/10/2025, 12:30</td>
                                            <td class="small">Khalid Al-Rashid</td>
                                            <td class="small"><span class="badge bg-danger">Rejected</span></td>
                                            <td class="small">03/10/2025, 11:45</td>
                                            <td class="small">Structural plans do not meet building codes</td>
                                            <td class="small"><span class="badge bg-danger">Final Rejected</span></td>
                                            <td class="small">04/10/2025, 16:30</td>
                                            <td class="small">Violation of zoning regulations and safety standards</td>
                                        </tr>
                                    </tbody>
                                </table>
                            </div>
                        </div>
                    </div>
                </div>
        </main>
    </div>

    <!-- Permit Details Modal -->
    <div class="modal fade" id="permitDetailsModal" tabindex="-1" aria-labelledby="permitDetailsModalLabel"
        aria-hidden="true">
        <div class="modal-dialog modal-xl">
            <div class="modal-content">
                <div class="modal-header">
                    <h5 class="modal-title" id="permitDetailsModalLabel">
                        <i class="fas fa-file-contract me-2"></i>Permit Details
                    </h5>
                    <button type="button" class="btn-close" data-bs-dismiss="modal" aria-label="Close"></button>
                </div>
                <div class="modal-body">
                    <div id="permitDetailsContent">
                        <!-- Content will be loaded dynamically -->
                    </div>
                </div>
                <div class="modal-footer">
                    <button type="button" class="btn btn-secondary" data-bs-dismiss="modal">Close</button>
                    <div id="permitActions">
                        <!-- Action buttons will be added dynamically based on permit status -->
                    </div>
                </div>
            </div>
        </div>
    </div>

    <!-- Update Password Modal -->
    <div class="modal fade" id="updatePasswordModal" tabindex="-1" aria-labelledby="updatePasswordModalLabel"
        aria-hidden="true">
        <div class="modal-dialog">
            <div class="modal-content">
                <div class="modal-header">
                    <h5 class="modal-title" id="updatePasswordModalLabel">
                        <i class="fas fa-key me-2"></i>Update Password
                    </h5>
                    <button type="button" class="btn-close" data-bs-dismiss="modal" aria-label="Close"></button>
                </div>
                <div class="modal-body">
                    <div id="passwordUpdateMessage" class="alert" style="display: none;"></div>
                    <form id="updatePasswordForm">
                        <div class="mb-3">
                            <label for="currentPassword" class="form-label">Current Password</label>
                            <div class="input-group">
                                <input type="password" class="form-control" id="currentPassword" required>
                                <button class="btn btn-outline-secondary" type="button"
                                    onclick="togglePassword('currentPassword')">
                                    <i class="fas fa-eye"></i>
                                </button>
                            </div>
                        </div>
                        <div class="mb-3">
                            <label for="newPassword" class="form-label">New Password</label>
                            <div class="input-group">
                                <input type="password" class="form-control" id="newPassword" required>
                                <button class="btn btn-outline-secondary" type="button"
                                    onclick="togglePassword('newPassword')">
                                    <i class="fas fa-eye"></i>
                                </button>
                            </div>
                            <div class="form-text">
                                Password must be at least 8 characters with 2 uppercase, 2 lowercase, 2 numbers, and 2
                                special characters.
                            </div>
                            <div id="passwordStrength" class="mt-2"></div>
                        </div>
                        <div class="mb-3">
                            <label for="confirmPassword" class="form-label">Confirm New Password</label>
                            <div class="input-group">
                                <input type="password" class="form-control" id="confirmPassword" required>
                                <button class="btn btn-outline-secondary" type="button"
                                    onclick="togglePassword('confirmPassword')">
                                    <i class="fas fa-eye"></i>
                                </button>
                            </div>
                        </div>
                    </form>
                </div>
                <div class="modal-footer">
                    <button type="button" class="btn btn-secondary" data-bs-dismiss="modal">Cancel</button>
                    <button type="button" class="btn btn-primary" onclick="updatePassword()">
                        <i class="fas fa-save me-2"></i>Update Password
                    </button>
                </div>
            </div>
        </div>
    </div>

    <!-- Update Profile Modal -->
    <div class="modal fade" id="updateProfileModal" tabindex="-1" aria-labelledby="updateProfileModalLabel"
        aria-hidden="true">
        <div class="modal-dialog">
            <div class="modal-content">
                <div class="modal-header">
                    <h5 class="modal-title" id="updateProfileModalLabel">
                        <i class="fas fa-user-edit me-2"></i>Update Profile
                    </h5>
                    <button type="button" class="btn-close" data-bs-dismiss="modal" aria-label="Close"></button>
                </div>
                <div class="modal-body">
                    <div id="profileUpdateMessage" class="alert" style="display: none;"></div>
                    <form id="updateProfileForm">
                        <div class="mb-3">
                            <label for="profileUsername" class="form-label">Full Name</label>
                            <input type="text" class="form-control" id="profileUsername" required>
                        </div>
                        <div class="mb-3">
                            <label for="profileEmail" class="form-label">Email</label>
                            <input type="email" class="form-control" id="profileEmail" required>
                        </div>
                        <div class="mb-3">
                            <label for="profileCompany" class="form-label">Company</label>
                            <input type="text" class="form-control" id="profileCompany">
                        </div>
                        <div class="mb-3">
                            <label for="profilePhone" class="form-label">Phone Number</label>
                            <input type="tel" class="form-control" id="profilePhone">
                        </div>
                    </form>
                </div>
                <div class="modal-footer">
                    <button type="button" class="btn btn-secondary" data-bs-dismiss="modal">Cancel</button>
                    <button type="button" class="btn btn-primary" onclick="updateProfile()">
                        <i class="fas fa-save me-2"></i>Update Profile
                    </button>
                </div>
            </div>
        </div>
    </div>

    <script src="../theme.js"></script>
    <script type="module" src="approver.js"></script>
    <!-- Bootstrap 5 JS Bundle (with Popper) -->
    <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.2/dist/js/bootstrap.bundle.min.js"></script>
</body>

</html>